import{d as oe,o as i,c as p,B as me,u as de,g as ve,b as pe,r as v,e as L,f as ge,w as se,h as fe,i as xe,a as e,n as R,F as M,j as N,k as u,l as f,T as ke,t as B,m as z,p as Z,q as a,_ as ee,N as te,s as E,v as we,C as ye,D as be,E as P,G as _e,A as Le,H as $e,z as Ce,I as Ie,L as De,J as ie,K as ue,M as Pe,O as Me,P as Ne}from"./index-768c9aff.js";import{_ as Be}from"./titleBar.vue_vue_type_script_setup_true_lang-57f7b35c.js";import{t as Ee}from"./throttle-5584dbda.js";import{c as ze}from"./index-c94da121.js";import{N as je}from"./InputGroup-51f180d1.js";const Se={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},We=me('<path d="M432 112V96a48.14 48.14 0 0 0-48-48H64a48.14 48.14 0 0 0-48 48v256a48.14 48.14 0 0 0 48 48h16" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></path><rect x="96" y="128" width="400" height="336" rx="45.99" ry="45.99" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><ellipse cx="372.92" cy="219.64" rx="30.77" ry="30.55" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"></ellipse><path d="M342.15 372.17L255 285.78a30.93 30.93 0 0 0-42.18-1.21L96 387.64" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path d="M265.23 464l118.59-117.73a31 31 0 0 1 41.46-1.87L496 402.91" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path>',5),Oe=[We],Te=oe({name:"ImagesOutline",render:function(j,$){return i(),p("svg",Se,Oe)}}),Ae={class:"min-h-full overflow-hidden flex flex-col"},He={class:"flex-1 min-h-full p-4 relative"},Ue=["id"],qe=["id","src","onLoad","onError","onClick"],Re={class:"menu p-2 text-[#cbd5e1]"},Ve={class:"prompt"},Fe={class:"flex justify-end items-end space-x-2"},Ge=["onClick"],Je={class:"text-sm dark:text-slate-400"},Ke=["onClick"],Qe={class:"text-sm dark:text-slate-400"},Xe=["onClick"],Ye={class:"text-sm dark:text-slate-400"},ce=oe({__name:"index",props:{dataList:{},scaleWidth:{},isDrawLike:{type:Boolean},usePropmpt:{type:Boolean},copyPropmpt:{type:Boolean},gap:{default:5},preOrigin:{type:Boolean}},emits:["loadMore","usePropmptDraw"],setup(V,{emit:j}){var y;const $=de(),h=V,w=j,S=(y=ve())==null?void 0:y.appContext.config.globalProperties.$viewerApi,F=pe(),b=v({}),x=v(0),g=v(160),k=v(0),_=v([]),C=v(null),I=v(0),G=L(()=>$.isLogin),W=L(()=>h.scaleWidth?Number(h.scaleWidth)*2+h.gap+150:150),O=ge();function d(){D(),T();const t=k.value,o=g.value,s=[];h.dataList.forEach((m,c)=>{const{width:X,height:Y}=m.fileInfo,ne=o/X,le=Y*ne+h.gap+x.value,q=b.value[m.id];if(s.length<t)q.style.top="0px",q.style.left=`${(o+h.gap)*c}px`,s.push(le);else{const ae=Math.min.apply(null,s),re=s.findIndex(he=>he===ae);q.style.top=`${ae+0}px`,q.style.left=`${re*(g.value+h.gap)}px`,s[re]+=le}}),I.value=Math.max(...s)+100}function J(t,o){t&&o&&(b.value[o.id]=t)}function D(){const{showName:t=0,showOther:o=0}={};x.value=[t,o].filter(s=>s).length*15}se(()=>h.scaleWidth,t=>{n()}),se(()=>h.dataList,t=>{t&&we(()=>{n()})},{immediate:!0});function T(){if(!C.value)return;const t=C.value.clientWidth;k.value=Math.floor(t/W.value);const o=t-k.value*W.value,s=(k.value-1)*h.gap;o-s<0&&(k.value-=1),g.value=Math.floor((t-s)/k.value)}function A(t,o){_.value.push(o.id)}function H(t,o){_.value.push(o.id)}function U(t){if(!G.value)return $.setLoginDialog(!0);const{prompt:o}=t;ze({text:o}),F.success("复制prompt成功")}function K(t){O.push(`/midjourney?mjId=${t.id}`)}function Q(t){const{prompt:o}=t;w("usePropmptDraw",o)}function r(t){const{fileInfo:o}=t,{cosUrl:s}=o;S({options:{},images:[s]})}const l=L(()=>t=>{const{fileInfo:o}=t,{width:s,height:m}=o;return m/(s/g.value)}),n=Ee(function(){d()},200);return fe(async()=>{window.addEventListener("resize",n);const t=document.getElementById("footer");new IntersectionObserver((s,m)=>{s.forEach(c=>{c.isIntersecting&&w("loadMore")})}).observe(t)}),xe(()=>{window.removeEventListener("resize",n)}),(t,o)=>(i(),p("div",Ae,[e("div",He,[e("div",{id:"wapper",ref_key:"wapperRef",ref:C,class:"wapper",style:R({height:`${I.value}px`})},[(i(!0),p(M,null,N(t.dataList,(s,m)=>(i(),p("div",{id:s.id,key:m,ref_for:!0,ref:c=>J(c,s),class:"wapper-item",style:R({width:`${g.value}px`})},[u(ke,{name:"img",css:!0},{default:f(()=>[e("img",{id:s.id,class:"item-file rounded-sm",style:R({width:`${g.value}px`,height:`${l.value(s)}px`}),src:t.preOrigin?s.fileInfo.cosUrl:s.fileInfo.thumbImg,loading:"lazy",onLoad:c=>A(c,s),onError:c=>H(c,s),onClick:c=>r(s)},null,44,qe)]),_:2},1024),e("div",Re,[e("div",Ve,B(s.fullPrompt),1),e("div",Fe,[t.isDrawLike?(i(),z(a(te),{key:0,trigger:"hover"},{trigger:f(()=>[e("button",{class:"flex h-5 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:Z(c=>K(s),["stop"])},[e("span",Je,[u(a(ee),{icon:"fluent:draw-image-24-regular",class:"text-sm"})])],8,Ge)]),default:f(()=>[o[0]||(o[0]=e("span",null,"画同款",-1))]),_:2},1024)):E("",!0),t.usePropmpt?(i(),z(a(te),{key:1,trigger:"hover"},{trigger:f(()=>[e("button",{class:"flex h-5 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:Z(c=>Q(s),["stop"])},[e("span",Qe,[u(a(ee),{icon:"fluent:draw-image-24-regular",class:"text-sm"})])],8,Ke)]),default:f(()=>[o[1]||(o[1]=e("span",null,"使用当前画同款",-1))]),_:2},1024)):E("",!0),t.copyPropmpt?(i(),z(a(te),{key:2,trigger:"hover"},{trigger:f(()=>[e("button",{class:"flex h-5 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:Z(c=>U(s),["stop"])},[e("span",Ye,[u(a(ee),{icon:"tabler:copy",class:"text-sm"})])],8,Xe)]),default:f(()=>[o[2]||(o[2]=e("span",null,"复制提示词",-1))]),_:2},1024)):E("",!0)])]),_.value.includes(s.id)?E("",!0):(i(),p("div",{key:0,class:"item-loading",style:R({width:`${g.value}px`,height:`${l.value(s)}px`})},null,4))],12,Ue))),128)),o[3]||(o[3]=e("div",{id:"footer",class:"w-full absolute bottom-[350px]"},null,-1))],4)])]))}});const Ze={class:"flex my-5"},et={class:"text-[#707384]"},tt={class:"flex items-center mt-5"},st=["onClick"],ot={class:"flex items-center mt-5"},nt=["onClick"],lt={class:"flex mt-5"},at=["onClick"],rt={key:0,class:"mt-8 pb-10"},it={class:"flex flex-wrap mt-8"},ut={key:0,class:"min-h-screen"},ct={key:0,class:"min-h-screen"},vt=oe({__name:"index",setup(V){const j=L(()=>S.theme),$=de(),h=L(()=>j.value==="dark"?"#fff":"#000"),{isMobile:w}=ye(),S=be(),F=L(()=>$.isLogin),b=v(0),x=v(!1),g=pe(),k=v([]),_=v([]),C=L(()=>S.theme==="dark");se(F,async(r,l)=>{r&&!l&&D()});const I=["超级逼真的未来世界，真实照片，虚幻引擎","帅哥，二次元，赛博朋克风格，精致脸庞","兔子，可爱，高质量，高品质"],G=[{label:"1024x1024",value:"1024x1024"},{label:"1024x1792",value:"1024x1792"},{label:"1792x1024",value:"1792x1024"}],W=[{label:"标准(2积分)",value:"standard"},{label:"优质(4积分)",value:"hd"}],O=["古风","二次元","写实照片","油画","水彩画","油墨画","黑白雕版画","雕塑","3D模型","手绘草图","炭笔画","极简线条画","电影质感","机械感"],d=v({prompt:"",n:1,size:"1024x1024",quality:"standard"});function J(){b.value=b.value+1>=I.length?0:b.value+1}async function D(){const r=await Me({model:"dall-e-3"});r.success&&(k.value=U(r.data))}async function T(){const r=await _e({size:999,rec:1,model:"dall-e-3"});if(!r.success)return g.error(r.message);_.value=U(r.data.rows)}function A(){}function H(r){d.value.prompt=r}function U(r){if(!r)return[];const l=[];return r.forEach(n=>{const{id:y,fileInfo:t,prompt:o,thumbImg:s}=n;let m=null;if(typeof t=="string")try{m=JSON.parse(t)}catch{m={}}else m=t||{};const{width:c,height:X,cosUrl:Y}=m;l.push({id:y,prompt:o,fullPrompt:o,fileInfo:{thumbImg:s,width:c,height:X,cosUrl:Y}})}),l.filter(n=>n.fileInfo&&n.fileInfo.width)}async function K(){if(!d.value.prompt)return g.error("请输入您想要生成的图片描述信息！");try{x.value=!0,await Ne(d.value),g.success("生成图片成完成、前往我的生成查看图片！"),await D(),x.value=!1}catch{x.value=!1}}function Q(r){r==="mine"&&D(),r==="all"&&T()}return fe(()=>{T()}),(r,l)=>(i(),p("div",{class:P(["main min-h-screen bg-center dark:bg-[#2F2E34]",[C.value?"darkBg":"lightBg",a(w)?"px-3":"px-10"]])},[u(a(Be),{title:"DALL-E绘画",des:"基于DALL-E的绘画、速度较快、同步等待到结束后在我的绘画中可以看到结果！",padding:a(w)?2:20},null,8,["padding"]),e("div",{class:P(a(w)?["px-2"]:["px-20"])},[e("div",Ze,[e("b",{class:"text-primary cursor-pointer select-none flex-shrink-0",onClick:J},"换示例"),l[1]||(l[1]=e("p",{class:"mx-2 text-[#707384] select-none flex-shrink-0"}," Prompt示例： ",-1)),e("p",et,B(I[b.value]),1)]),u(a(je),null,{default:f(()=>[u(a(Le),{value:d.value.prompt,"onUpdate:value":l[0]||(l[0]=n=>d.value.prompt=n),disabled:x.value,clearable:"",placeholder:"请输入您想要生成的图片描述信息、可以参考上面的示例文字、我们将会对其转为英文绘画、请知悉！"},null,8,["value","disabled"]),u(a($e),{type:"success",loading:x.value,disabled:x.value,onClick:K},{icon:f(()=>[u(a(Ce),null,{default:f(()=>[u(a(Te))]),_:1})]),default:f(()=>[l[2]||(l[2]=Ie(" 生成图片 "))]),_:1},8,["loading","disabled"])]),_:1}),e("div",{class:P(["mt-5 py-4 bg-[#e7eaf380] dark:bg-[#2c2c32] rounded-lg",a(w)?"px-0":"px-4"])},[l[6]||(l[6]=e("h4",{class:"text-base mb-2"}," 参数设置 ",-1)),e("div",tt,[l[3]||(l[3]=e("span",{class:"mr-2 inline-block w-20 flex-shrink-0"},"图片尺寸:",-1)),e("div",null,[(i(),p(M,null,N(G,n=>e("span",{key:n.value,class:P(["rounded ml-2 select-none cursor-pointer inline-block mb-2",[n.value===d.value.size?["text-primary","bg-[#0d6efd1c]"]:["bg-[#bfc4d033]"],a(w)?"px-1.5 py-0.5":"px-3 py-1"]]),onClick:y=>d.value.size=n.value},B(n.label),11,st)),64))])]),e("div",ot,[l[4]||(l[4]=e("span",{class:"mr-2 inline-block w-20 flex-shrink-0"},"图片质量:",-1)),e("div",null,[(i(),p(M,null,N(W,n=>e("span",{key:n.value,class:P(["py-0.5 px-2.5 rounded ml-2 select-none cursor-pointer inline-block mb-2",n.value===d.value.quality?["text-primary","bg-[#0d6efd1c]"]:["bg-[#bfc4d033]"]]),onClick:y=>d.value.quality=n.value},B(n.label),11,nt)),64))])]),l[7]||(l[7]=e("div",{class:"flex mt-5"},[e("h4",{class:"text-base mr-2 w-20 flex-shrink-0"}," 修饰词参考 "),e("p",{class:"text-[#707384]"}," 您可参考或选用下列各类修饰词丰富您的输入文本，尝试生成更加多样的图像，更多修饰词可参考 Prompt指南 或 自由输入 探索大模型作画更多未知能力 ")],-1)),e("div",lt,[l[5]||(l[5]=e("h4",{class:"text-base mr-2 w-20 flex-shrink-0"}," 图像类型 ",-1)),e("div",null,[(i(),p(M,null,N(O,(n,y)=>e("span",{key:n,class:"cursor-pointer hover:text-primary",onClick:t=>d.value.prompt+=d.value.prompt?`，${n}`:n},B(`${n} ${y+1===O.length?"":"、"}`),9,at)),64))])])],2),x.value?(i(),p("div",rt,[l[8]||(l[8]=e("div",{class:"flex justify-center"}," ----------- 正在生成中、图片越大数量越多所需时间越多、预计25S ----------- ",-1)),e("div",it,[(i(!0),p(M,null,N(d.value.n,n=>(i(),p("div",{class:"w-44 h-44 border rounded-md relative ml-4 mt-4",key:n},[u(De,{"text-color":h.value,words:["图","片","绘","制","中"]},null,8,["text-color"])]))),128))])])):E("",!0),u(a(Pe),{type:"line",animated:"",class:"mt-5","onUpdate:value":Q},{default:f(()=>[u(a(ie),{name:"all",tab:"公共生成"},{default:f(()=>[_.value.length?(i(),p("div",ut,[u(ce,{onLoadMore:A,usePropmpt:"",gap:8,preOrigin:"",onUsePropmptDraw:H,dataList:_.value,scaleWidth:50},null,8,["dataList"])])):(i(),z(a(ue),{key:1,size:"huge",class:"mt-20",description:"暂无数据哟~"}))]),_:1}),u(a(ie),{name:"mine",tab:"我的生成"},{default:f(()=>[k.value.length?(i(),p("div",ct,[u(ce,{onLoadMore:A,usePropmpt:"",gap:8,preOrigin:"",onUsePropmptDraw:H,dataList:k.value,scaleWidth:50},null,8,["dataList"])])):(i(),z(a(ue),{key:1,size:"huge",class:"mt-20",description:"暂无数据哟~"}))]),_:1})]),_:1})],2)],2))}});export{vt as default};
