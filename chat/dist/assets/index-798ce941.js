import{_ as A}from"./titleBar.vue_vue_type_script_setup_true_lang-57f7b35c.js";import{d as D,u as V,C as $,b as z,ad as F,e as y,r as _,h as U,c as i,k as n,E as S,q as l,a as e,l as b,n as C,F as N,j as B,s as E,bE as H,o as d,J as M,M as Z,t as o,I as K,_ as Q,bL as h,U as j,bZ as X}from"./index-768c9aff.js";const Y={class:"main min-h-screen bg-center dark:bg-[#2F2E34] h-full flex flex-col overflow-hidden"},ee={key:0,class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-6 gap-y-10 px-4"},te=["onClick"],se={class:"w-full rounded-t-xl overflow-hidden border dark:border-[#ffffff17] relative",style:{height:"40%"}},ae=["src"],le={class:"absolute left-1/2 bottom-0 transform -translate-x-1/2 -translate-y-1/2 text-lg text-[#fff] ]"},ne={class:"p-5 text-lg h-[160px] border-b dark:border-[#ffffff17] overflow-hidden relative"},oe={class:"absolute bottom-1 right-2 font-semibold text-red-500 italic"},re={class:"flex p-4 border-b dark:border-[#ffffff17] flex-col space-y-4"},ie={class:"flex justify-between"},de={class:"flex justify-between"},ce={class:"flex justify-between"},fe={class:"px-4 flex-1 flex items-center justify-between"},ue={class:"flex items-end"},pe={class:"ml-2 text-[#3076fd] text-lg"},ge={key:1,class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-6 gap-y-10 px-4"},xe={class:"w-full rounded-t-xl overflow-hidden",style:{height:"40%"}},ye={class:"p-5 text-lg h-[160px] border-b dark:border-[#ffffff17] overflow-ellipsis"},he={class:"flex p-4 border-b dark:border-[#ffffff17] flex-col space-y-4"},ve={class:"px-4 flex-1 flex items-center justify-between"},we=D({__name:"index",setup(_e){const p=V(),{isMobile:c}=$(),v=z(),g=F(),P=y(()=>{var t;const s=window.navigator.userAgent.toLowerCase();return s.match(/MicroMessenger/i)&&((t=s==null?void 0:s.match(/MicroMessenger/i))==null?void 0:t[0])==="micromessenger"}),f=y(()=>{const{payHupiStatus:s,payEpayStatus:t,payMpayStatus:a,payWechatStatus:r}=p.globalConfig;return Number(r)===1?"wechat":Number(a)===1?"mpay":Number(s)===1?"hupi":Number(t)===1?"epay":null}),W=y(()=>{const{payEpayChannel:s,payMpayChannel:t}=p.globalConfig;return f.value==="wechat"?["wxpay"]:f.value==="epay"?s?JSON.parse(s):[]:f.value==="mpay"?t?JSON.parse(t):[]:f.value==="hupi"?["wxpay"]:[]}),m=_([]),w=_(1),u=_(!1);async function k(){try{u.value=!0;const s=await H({status:1,type:w.value,size:30});m.value=s.data.rows,u.value=!1}catch{u.value=!1}}const I=y(()=>c.value?"尽情探索，欢迎光临我们的在线商店！":"尽情探索，欢迎光临我们的在线商店、感谢您选择我们、让我们一同开启愉悦的购物之旅！");function J(s){w.value=s,k()}async function T(s){W.value.length||v.warning("管理员还未开启支付！"),L(s)}async function L(s){if(P.value&&f.value==="wechat"&&Number(p.globalConfig.payWechatStatus)===1){if(typeof WeixinJSBridge>"u")document.addEventListener?document.addEventListener("WeixinJSBridgeReady",x,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",x),document.attachEvent("onWeixinJSBridgeReady",x));else{const t=await X({goodsId:s.id,payType:"jsapi"}),{success:a,data:r}=t;a&&x(r)}return}g.updateOrderInfo({pkgInfo:s}),g.updateGoodsDialog(!1),g.updatePayDialog(!0)}function x(s){const{appId:t,timeStamp:a,nonceStr:r,package:G,signType:O,paySign:R}=s;t&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t,timeStamp:a,nonceStr:r,package:G,signType:O,paySign:R},q=>{q.err_msg==="get_brand_wcpay_request:ok"?(v.success("购买成功、祝您使用愉快!"),setTimeout(()=>{p.getUserInfo(),g.updateGoodsDialog(!1)},500)):v.warning("您还没有支付成功哟！")})}return U(()=>{k()}),(s,t)=>(d(),i("div",Y,[n(l(A),{title:"会员商场",des:I.value,class:S([l(c)?"px-3":"px-24"])},null,8,["des","class"]),e("div",{class:"flex justify-center items-center",style:C({height:l(c)?"60px":"180px"})},[n(l(Z),{type:"segment",style:C({width:l(c)?"90%":"400px"}),"onUpdate:value":J},{default:b(()=>[n(l(M),{name:1,tab:"会员限时套餐"}),n(l(M),{name:-1,tab:"叠加永久次卡"})]),_:1},8,["style"])],4),e("div",{class:S(["flex-1 pb-10 overflow-y-auto",[l(c)?"px-3":"px-28"]])},[u.value?E("",!0):(d(),i("div",ee,[(d(!0),i(N,null,B(m.value,a=>(d(),i("div",{key:a.id,class:"border dark:border-[#ffffff17] h-[580px] rounded-xl card-item flex flex-col",onClick:r=>T(a)},[e("div",se,[e("img",{src:a.coverImg,class:"object-cover w-full h-full cover",alt:""},null,8,ae),e("div",le,o(a.name),1)]),e("div",ne,[K(o(a.des)+" ",1),e("span",oe,"￥"+o(a.price),1)]),e("div",re,[e("div",ie,[t[0]||(t[0]=e("span",null,"基础模型额度",-1)),e("span",null,o(a.model3Count||0)+" 积分",1)]),e("div",de,[t[1]||(t[1]=e("span",null,"高级模型额度",-1)),e("span",null,o(a.model4Count||0)+" 积分",1)]),e("div",ce,[t[2]||(t[2]=e("span",null,"MJ绘画额度",-1)),e("span",null,o(a.drawMjCount||0)+" 积分",1)])]),e("div",fe,[e("div",ue,[t[3]||(t[3]=e("span",null,"套餐有效期 ",-1)),e("span",pe,o(a.days>0?`${a.days} 天`:"永久"),1)]),t[4]||(t[4]=e("div",{class:"line"},null,-1)),e("div",null,[n(l(Q),{class:"text-lg right-icon",icon:"bi:arrow-right"})])])],8,te))),128))])),u.value?(d(),i("div",ge,[(d(),i(N,null,B(4,a=>e("div",{key:a,class:"border dark:border-[#ffffff17] h-[580px] rounded-xl card-item flex flex-col"},[e("div",xe,[n(l(h),{height:"100%",width:"100%"})]),e("div",ye,[n(l(j),{vertical:""},{default:b(()=>[n(l(h),{text:"",repeat:4,width:"100%",sharp:!1})]),_:1})]),e("div",he,[n(l(j),{vertical:""},{default:b(()=>[n(l(h),{text:"",repeat:4,width:"100%",sharp:!1})]),_:1})]),e("div",ve,[n(l(h),{text:"",repeat:1,width:"100%",sharp:!1})])])),64))])):E("",!0)],2)]))}});export{we as default};
