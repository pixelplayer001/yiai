
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as F}from"./index-ffb2bbfd.js";import{A as x}from"./sales-d7269b7d.js";import{d as G,r as _,O as V,q as T,h as n,P as H,o as I,c as J,e,f as a,k as r,b as g,w as K,G as Q,a as W,t as w,S as X,E as Y,n as S}from"./index-6b0fe787.js";const Z=["src"],E=G({__name:"salesUser",setup(ee){const C=_(),N=_(0),b=_(!1),m=_(!1),U=_(),i=V({performanceRatio:0,salesOutletName:"",userId:0}),s=V({salesOutletName:"",performanceRatio:null,page:1,size:10}),A=V({performanceRatio:[{required:!0,message:"请填写佣金比例",trigger:"blur"}],salesOutletName:[{required:!0,message:"请填写自定义分销名称",trigger:"blur"}]}),k=_([]);async function f(){try{b.value=!0;const o=await x.querySalesUserList(s);b.value=!1;const{rows:t,count:d}=o.data;N.value=d,k.value=t}catch{b.value=!1}}function B(o){o==null||o.resetFields(),f()}async function M(o){o==null||o.validate(async t=>{t&&(await x.updateSalesUser(i),Y.success("修改信息成功！"),m.value=!1,f())})}async function q(o){const{userId:t,performanceRatio:d,salesOutletName:p}=o;i.performanceRatio=d,i.salesOutletName=p,m.value=!0,i.userId=t}return T(()=>{f()}),(o,t)=>{const d=n("el-input"),p=n("el-form-item"),y=n("el-button"),O=n("el-form"),v=F,D=n("el-alert"),u=n("el-table-column"),c=n("el-tag"),$=n("el-table"),h=n("el-pagination"),j=n("el-row"),L=n("el-dialog"),P=H("loading");return I(),J("div",null,[e(v,null,{default:a(()=>[e(O,{ref_key:"formRef",ref:C,inline:!0,model:s},{default:a(()=>[e(p,{label:"分销人代号",prop:"salesOutletName"},{default:a(()=>[e(d,{modelValue:s.salesOutletName,"onUpdate:modelValue":t[0]||(t[0]=l=>s.salesOutletName=l),placeholder:"填写分销人代号搜索"},null,8,["modelValue"])]),_:1}),e(p,{label:"返佣比例",prop:"performanceRatio"},{default:a(()=>[e(d,{modelValue:s.performanceRatio,"onUpdate:modelValue":t[1]||(t[1]=l=>s.performanceRatio=l),placeholder:"填写分销人返佣比例"},null,8,["modelValue"])]),_:1}),e(p,null,{default:a(()=>[e(y,{type:"primary",onClick:f},{default:a(()=>t[10]||(t[10]=[r(" 查询 ")])),_:1}),e(y,{onClick:t[2]||(t[2]=l=>B(g(C)))},{default:a(()=>t[11]||(t[11]=[r(" 重置 ")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(v,null,{default:a(()=>[e(D,{"show-icon":"",title:"佣金账户设置说明",description:"佣金设置实时生效、佣金比例用户用户邀请的成员下单后的结算比例、分销人代号会在分销页面展示！",type:"success"})]),_:1}),e(v,{style:{width:"100%"}},{default:a(()=>[K((I(),Q($,{border:"",data:g(k),style:{width:"100%"},size:"large"},{default:a(()=>[e(u,{prop:"userInfo.avatar",label:"头像",width:"120"},{default:a(l=>{var R,z;return[W("img",{src:(z=(R=l.row)==null?void 0:R.userInfo)==null?void 0:z.avatar,style:{height:"50px"}},null,8,Z)]}),_:1}),e(u,{prop:"userInfo.email",label:"邮箱",width:"200"}),e(u,{prop:"salesOutletName",label:"分销人代号",width:"120"}),e(u,{prop:"performanceRatio",label:"分销人佣金比例",align:"center"},{default:a(l=>[e(c,null,{default:a(()=>[r(w(l.row.performanceRatio)+"% ",1)]),_:2},1024)]),_:1}),e(u,{prop:"orderCount",label:"累计分销订单量",align:"center"},{default:a(l=>[e(c,{type:"success"},{default:a(()=>[r(w(l.row.orderCount),1)]),_:2},1024)]),_:1}),e(u,{prop:"totalAmount",label:"分销人账户总金额",align:"center",width:"150"},{default:a(l=>[e(c,{type:l.row.totalAmount>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(l.row.totalAmount),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"withdrawalAmount",label:"分销人已提现金额",align:"center",width:"150"},{default:a(l=>[e(c,{type:l.row.withdrawalAmount>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(l.row.withdrawalAmount),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"distributionBalance",label:"分销人可提现金额",align:"center",width:"150"},{default:a(l=>[e(c,{type:l.row.distributionBalance>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(l.row.distributionBalance),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"drawMoneyIn",label:"分销人正在提现金额",align:"center"},{default:a(l=>[e(c,{type:l.row.drawMoneyIn>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(l.row.drawMoneyIn),1)]),_:2},1032,["type"])]),_:1}),e(u,{fixed:"right",label:"操作",width:"100",align:"center"},{default:a(l=>[e(y,{link:"",type:"primary",size:"small",onClick:R=>q(l.row)},{default:a(()=>t[12]||(t[12]=[r(" 变更用户 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[P,g(b)]]),e(j,{class:"flex justify-end mt-5"},{default:a(()=>[e(h,{"current-page":s.page,"onUpdate:currentPage":t[3]||(t[3]=l=>s.page=l),"page-size":s.size,"onUpdate:pageSize":t[4]||(t[4]=l=>s.size=l),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:g(N),onSizeChange:f,onCurrentChange:f},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(L,{modelValue:g(m),"onUpdate:modelValue":t[9]||(t[9]=l=>X(m)?m.value=l:null),title:"修改用户权限",width:"450px"},{footer:a(()=>[e(y,{onClick:t[7]||(t[7]=l=>m.value=!1)},{default:a(()=>t[13]||(t[13]=[r(" 我再想想 ")])),_:1}),e(y,{type:"primary",onClick:t[8]||(t[8]=l=>M(g(U)))},{default:a(()=>t[14]||(t[14]=[r(" 确认修改 ")])),_:1})]),default:a(()=>[e(O,{ref_key:"cramiRef",ref:U,model:i,rules:A,"label-width":"105px"},{default:a(()=>[e(p,{label:"佣金比例",prop:"performanceRatio"},{default:a(()=>[e(d,{modelValue:i.performanceRatio,"onUpdate:modelValue":t[5]||(t[5]=l=>i.performanceRatio=l),modelModifiers:{number:!0},type:"number",placeholder:"设置佣金比例"},null,8,["modelValue"])]),_:1}),e(p,{label:"自定义名称",prop:"salesOutletName"},{default:a(()=>[e(d,{modelValue:i.salesOutletName,"onUpdate:modelValue":t[6]||(t[6]=l=>i.salesOutletName=l),placeholder:"设置自定义名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});typeof S=="function"&&S(E);export{E as default};
