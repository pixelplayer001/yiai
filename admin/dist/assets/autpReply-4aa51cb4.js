
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as oe}from"./index-ffb2bbfd.js";import{W as V,d as ae,O as S,r as c,z as ne,q as se,h as n,P as ue,o as A,c as M,e as t,f as o,j as re,l as pe,Q as ie,R as de,b as s,k as p,w as me,G as Y,t as R,a as fe,S as ce,E as k,V as _e,n as N}from"./index-6b0fe787.js";import{u as O}from"./utcformatTime-e76e5157.js";import{b as ye,Q as ge}from"./index-39bad72e.js";const C={queryAutoReply:i=>V.get("autoreply/query",{params:i}),delAutoReply:i=>V.post("autoreply/del",i),addAutoReply:i=>V.post("autoreply/add",i),updateAutoReply:i=>V.post("autoreply/update",i)},ve={class:"dialog-footer"},we=ae({__name:"autpReply",setup(i){const u=S({prompt:"",status:void 0,page:1,size:10}),m=c(!1),b=c(!1),g=c(0),U=c(0),T=c(),x=c(),r=S({status:0,prompt:"",answer:""}),P=S({status:[{required:!0,message:"请选择套餐类型",trigger:"change"}],prompt:[{required:!0,message:"请填写预设问题",trigger:"blur"}],answer:[{required:!0,message:"请填写回复答案",trigger:"blur"}]}),D=c([]);async function d(){try{b.value=!0;const a=await C.queryAutoReply(u),{rows:e,count:v}=a.data;b.value=!1,U.value=v,D.value=e}catch{b.value=!1}}async function I(a){await C.delAutoReply({id:a}),k.success("删除自定义问题成功"),await d()}function j(a){a==null||a.resetFields(),d()}function B(a){g.value=a.id;const{status:e,prompt:v,answer:w}=a;m.value=!0,_e(()=>{Object.assign(r,{status:e,prompt:v,answer:w})})}const $=ne(()=>g.value!==0);function Q(a){a==null||a.resetFields(),g.value=0}async function h(a){a==null||a.validate(async e=>{if(!e)return k.warning("请按规则填写所有信息！");g.value===0?(await C.addAutoReply(r),k.success("添加自定义问题成功")):(await C.updateAutoReply({id:g.value,...r}),k.success("更新自定义问题成功")),m.value=!1,d()})}return se(()=>{d()}),(a,e)=>{const v=n("el-alert"),w=oe,z=n("el-input"),_=n("el-form-item"),F=n("el-option"),K=n("el-select"),f=n("el-button"),L=n("Plus"),G=n("el-icon"),q=n("el-form"),y=n("el-table-column"),W=n("el-tag"),H=n("el-popconfirm"),J=n("el-table"),X=n("el-pagination"),Z=n("el-row"),E=n("el-switch"),ee=n("el-dialog"),te=ue("loading");return A(),M("div",null,[t(w,null,{default:o(()=>[t(v,{closable:!1,"show-icon":"",title:"自定义回复说明",description:"当前可设置自定义回复、且可以多种关键词触发回复相同内容、可以开启精准匹配或模糊匹配用户设置自定义回复程度。",type:"success"})]),_:1}),t(w,null,{default:o(()=>[t(q,{ref_key:"formRef",ref:T,inline:!0,model:u},{default:o(()=>[t(_,{label:"自定义问题",prop:"prompt"},{default:o(()=>[t(z,{modelValue:u.prompt,"onUpdate:modelValue":e[0]||(e[0]=l=>u.prompt=l),placeholder:"自定义问题[模糊搜索]",onKeydown:re(pe(d,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),_:1}),t(_,{label:"问题启用状态",prop:"status"},{default:o(()=>[t(K,{modelValue:u.status,"onUpdate:modelValue":e[1]||(e[1]=l=>u.status=l),placeholder:"请选择问题启用状态",clearable:""},{default:o(()=>[(A(!0),M(ie,null,de(s(ye),l=>(A(),Y(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(_,null,{default:o(()=>[t(f,{type:"primary",onClick:d},{default:o(()=>e[13]||(e[13]=[p(" 查询 ")])),_:1}),t(f,{onClick:e[2]||(e[2]=l=>j(s(T)))},{default:o(()=>e[14]||(e[14]=[p(" 重置 ")])),_:1})]),_:1}),t(f,{type:"success",style:{float:"right"},onClick:e[3]||(e[3]=l=>m.value=!0)},{default:o(()=>[e[15]||(e[15]=p(" 添加新的自动回复 ")),t(G,{class:"ml-3"},{default:o(()=>[t(L)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(w,{style:{width:"100%"}},{default:o(()=>[me((A(),Y(J,{border:"",data:s(D),style:{width:"100%"},size:"large"},{default:o(()=>[t(y,{prop:"prompt",label:"提问关键词"}),t(y,{prop:"answer",label:"回复答案"}),t(y,{prop:"status",label:"问题状态",width:"120"},{default:o(l=>[t(W,{type:l.row.status===1?"success":"daner"},{default:o(()=>[p(R(s(ge)[l.row.status]),1)]),_:2},1032,["type"])]),_:1}),t(y,{prop:"createdAt",label:"创建时间",width:"200"},{default:o(l=>[p(R(s(O)(l.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(y,{prop:"updatedAt",label:"最后修改时间",width:"200"},{default:o(l=>[p(R(s(O)(l.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(y,{fixed:"right",label:"操作",width:"200"},{default:o(l=>[t(f,{link:"",type:"primary",size:"small",onClick:le=>B(l.row)},{default:o(()=>e[16]||(e[16]=[p(" 编辑 ")])),_:2},1032,["onClick"]),t(H,{"confirm-button-text":"确认删除","cancel-button-text":"放弃",type:"danger",width:"230px","icon-color":"red",title:"确定删除本条自动回复问题么？",onConfirm:le=>I(l.row.id)},{reference:o(()=>[t(f,{link:"",type:"danger",size:"small"},{default:o(()=>e[17]||(e[17]=[p(" 删除 ")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[te,s(b)]]),t(Z,{class:"flex justify-end mt-5"},{default:o(()=>[t(X,{"current-page":u.page,"onUpdate:currentPage":e[4]||(e[4]=l=>u.page=l),"page-size":u.size,"onUpdate:pageSize":e[5]||(e[5]=l=>u.size=l),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:s(U),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),t(ee,{modelValue:s(m),"onUpdate:modelValue":e[11]||(e[11]=l=>ce(m)?m.value=l:null),title:`${s($)?"编辑":"添加"}自动回复问题`,width:"480",onClose:e[12]||(e[12]=l=>Q(s(x)))},{footer:o(()=>[fe("span",ve,[t(f,{onClick:e[9]||(e[9]=l=>m.value=!1)},{default:o(()=>e[18]||(e[18]=[p("放弃生成")])),_:1}),t(f,{type:"primary",onClick:e[10]||(e[10]=l=>h(s(x)))},{default:o(()=>[p(R(`${s($)?"更新":"新增"}回复 `),1)]),_:1})])]),default:o(()=>[t(q,{ref_key:"formAutoReplyRef",ref:x,"label-position":"right","label-width":"80px",model:r,rules:P},{default:o(()=>[t(_,{label:"开启状态",prop:"status"},{default:o(()=>[t(E,{modelValue:r.status,"onUpdate:modelValue":e[6]||(e[6]=l=>r.status=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(_,{label:"提问问题",prop:"prompt"},{default:o(()=>[t(z,{modelValue:r.prompt,"onUpdate:modelValue":e[7]||(e[7]=l=>r.prompt=l),type:"textarea",rows:5,placeholder:"请填写预设提问问题"},null,8,["modelValue"])]),_:1}),t(_,{label:"回复问题",prop:"answer"},{default:o(()=>[t(z,{modelValue:r.answer,"onUpdate:modelValue":e[8]||(e[8]=l=>r.answer=l),type:"textarea",rows:5,placeholder:"请填写预设回复答案"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});typeof N=="function"&&N(we);export{we as default};
