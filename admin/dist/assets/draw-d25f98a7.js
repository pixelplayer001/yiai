
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as J}from"./index-ffb2bbfd.js";import{A as Q}from"./mj-ece5771b.js";import{A as V}from"./chat-d63f1410.js";import{u as K}from"./utcformatTime-e76e5157.js";import{d as X,W as Z,e as ee}from"./index-39bad72e.js";import{d as te,r as v,O as le,q as ae,h as o,P as oe,o as _,c as C,e as t,f as l,Q as P,R,b as c,k as u,a as b,w as ne,G as I,t as f,E as $,n as L}from"./index-6b0fe787.js";const re={style:{float:"right"}},se={class:"answer"},ie={class:"answer_container"},ue=["src"],de=te({__name:"draw",setup(pe){const D=v(),k=v(0),w=v(!1),s=le({rec:null,status:null,page:1,size:10}),z=v([]);async function d(){try{w.value=!0;const r=await Q.queryAdminDrawList(s);w.value=!1;const{rows:a,count:g}=r.data;k.value=g,z.value=a}catch{w.value=!1}}function N(r){r==null||r.resetFields(),d()}async function j(r){const a=await V.recMjDrawImg({id:r});$.success(a.data),d()}async function B(r){const a=await V.delChatLog({id:r});$.success(a.data),d()}return ae(()=>{d()}),(r,a)=>{const g=o("el-option"),A=o("el-select"),y=o("el-form-item"),m=o("el-button"),O=o("el-form"),h=J,W=o("el-alert"),n=o("el-table-column"),Y=o("el-image"),S=o("el-tag"),q=o("el-popover"),T=o("el-popconfirm"),F=o("el-table"),E=o("el-pagination"),G=o("el-row"),H=oe("loading");return _(),C("div",null,[t(h,null,{default:l(()=>[t(O,{ref_key:"formRef",ref:D,inline:!0,model:s},{default:l(()=>[t(y,{label:"推荐状态",prop:"rec"},{default:l(()=>[t(A,{modelValue:s.rec,"onUpdate:modelValue":a[0]||(a[0]=e=>s.rec=e),placeholder:"请选择推荐状态",clearable:""},{default:l(()=>[(_(!0),C(P,null,R(c(X),e=>(_(),I(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"绘制状态",prop:"status"},{default:l(()=>[t(A,{modelValue:s.status,"onUpdate:modelValue":a[1]||(a[1]=e=>s.status=e),placeholder:"请选择绘制状态",clearable:""},{default:l(()=>[(_(!0),C(P,null,R(c(Z),e=>(_(),I(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,null,{default:l(()=>[t(m,{type:"primary",onClick:d},{default:l(()=>a[5]||(a[5]=[u(" 查询 ")])),_:1}),t(m,{onClick:a[2]||(a[2]=e=>N(c(D)))},{default:l(()=>a[6]||(a[6]=[u(" 重置 ")])),_:1})]),_:1}),b("span",re,[t(m,{type:"success",onClick:d},{default:l(()=>a[7]||(a[7]=[u(" 刷新列表 ")])),_:1})])]),_:1},8,["model"])]),_:1}),t(h,null,{default:l(()=>[t(W,{"show-icon":"",title:"MJ绘图历史说明",description:"点击推荐的图片将会出现在画廊当中！",type:"success"})]),_:1}),t(h,{style:{width:"100%"}},{default:l(()=>[ne((_(),I(F,{border:"",data:c(z),style:{width:"100%"},size:"large"},{default:l(()=>[t(n,{prop:"id",align:"center",label:"ID",width:"70"}),t(n,{prop:"drawUrl",align:"center",label:"绘图结果"},{default:l(e=>{var i,p;return[t(Y,{style:{height:"120px"},"preview-teleported":"",fit:"contain","preview-src-list":[(i=e.row)==null?void 0:i.drawUrl],src:(p=e.row)==null?void 0:p.drawUrl,lazy:"","hide-on-click-modal":""},null,8,["preview-src-list","src"])]}),_:1}),t(n,{prop:"userInfo.username",align:"center",label:"用户名",width:"120"}),t(n,{prop:"fileInfo.thumbImg",align:"center",label:"推荐状态",width:"90"},{default:l(e=>[t(S,{type:e.row.rec===1?"success":""},{default:l(()=>[u(f(e.row.rec===1?"已推荐":"未推荐"),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"userInfo.email",label:"邮箱",width:"180",align:"center"}),t(n,{prop:"status",align:"center",label:"绘图状态",width:"105"},{default:l(e=>[t(S,{type:e.row.status===100?"success":""},{default:l(()=>[u(f(c(ee)[e.row.status]),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"fullPrompt",label:"绘图指令",align:"center",width:"200"},{default:l(e=>[t(q,{placement:"top",width:400,trigger:"click"},{reference:l(()=>[b("div",se,f(e.row.fullPrompt),1)]),default:l(()=>[b("div",ie,f(e.row.fullPrompt),1)]),_:2},1024)]),_:1}),t(n,{prop:"progress",align:"center",label:"绘图进度",width:"90"}),t(n,{prop:"fileInfo.thumbImg",align:"center",label:"绘图尺寸",width:"120"},{default:l(e=>{var i,p,x,M,U;return[u(f((i=e.row)!=null&&i.fileInfo?`${(x=(p=e.row)==null?void 0:p.fileInfo)==null?void 0:x.width}*${(U=(M=e.row)==null?void 0:M.fileInfo)==null?void 0:U.height}`:"---"),1)]}),_:1}),t(n,{prop:"userInfo.avatar",label:"用户头像",width:"90"},{default:l(e=>{var i,p;return[b("img",{src:(p=(i=e.row)==null?void 0:i.userInfo)==null?void 0:p.avatar,style:{height:"50px"}},null,8,ue)]}),_:1}),t(n,{prop:"createdAt",label:"提问时间",align:"center",width:"200"},{default:l(e=>[u(f(c(K)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(n,{fixed:"right",label:"操作",width:"200",align:"center"},{default:l(e=>[t(T,{title:`确认${e.row.rec===1?"取消推荐":"推荐"}图片吗！`,width:"260","icon-color":"red",onConfirm:i=>j(e.row.id)},{reference:l(()=>[t(m,{link:"",type:e.row.rec===1?"success":"",size:"small"},{default:l(()=>a[8]||(a[8]=[u(" 推荐图片 ")])),_:2},1032,["type"])]),_:2},1032,["title","onConfirm"]),t(T,{title:"`确认删除此条记录么！",width:"260","icon-color":"red",onConfirm:i=>B(e.row.id)},{reference:l(()=>[t(m,{type:"warning",size:"small"},{default:l(()=>a[9]||(a[9]=[u(" 删除记录 ")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[H,c(w)]]),t(G,{class:"flex justify-end mt-5"},{default:l(()=>[t(E,{"current-page":s.page,"onUpdate:currentPage":a[3]||(a[3]=e=>s.page=e),"page-size":s.size,"onUpdate:pageSize":a[4]||(a[4]=e=>s.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:c(k),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1})])}}});typeof L=="function"&&L(de);export{de as default};
