
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as O}from"./index-ffb2bbfd.js";import{a as m}from"./config-e982e661.js";import{d as D,O as j,r as _,q as B,h as n,o as M,c as g,e,f as l,a as b,k as x,Q as E,R as L,E as V,t as J,n as U}from"./index-6b0fe787.js";const z={class:"flex justify-between"},F=D({__name:"mpay",setup(K){const t=j({payMpayStatus:"",payMpayPid:"",payMpaySecret:"",payMpayNotifyUrl:"",payMpayReturnUrl:"",payMpayApiPayUrl:"",payMpayRedirect:"",payMpayChannel:[]}),C=_({payMpayStatus:[{required:!0,trigger:"change",message:"请选择当前支付开启状态"}],payMpaySecret:[{required:!0,trigger:"blur",message:"请填写支付秘钥"}],payMpayPid:[{required:!0,trigger:"blur",message:"请填写商户PID"}],payMpayNotifyUrl:[{required:!0,trigger:"blur",message:"请填写支付通知地址"}],payMpayApiPayUrl:[{required:!0,trigger:"blur",message:"请填写平台支付API请求地址"}]}),d=_(),P=[{label:"微信支付",value:"wxpay"},{label:"支付宝支付",value:"alipay"}];async function i(){const o=await m.queryConfig({keys:["payMpaySecret","payMpayNotifyUrl","payMpayReturnUrl","payMpayPid","payMpayStatus","payMpayApiPayUrl","payMpayRedirect","payMpayChannel"]}),a=o.data.payMpayChannel?JSON.parse(o.data.payMpayChannel):[];Object.assign(t,o.data,{payMpayChannel:a})}function S(){var o;(o=d.value)==null||o.validate(async a=>{if(a){try{await m.setConfig({settings:v(t)}),V.success("变更配置信息成功")}catch{}i()}else V.error("请填写完整信息")})}function h(o,a){if(["payMpayChannel"].includes(o)){if(!a)return[];if(a)return JSON.stringify(a)}else return a}function v(o){return Object.keys(o).map(a=>({configKey:a,configVal:h(a,o[a])}))}return B(()=>{i()}),(o,a)=>{const f=n("el-alert"),k=O,w=n("el-button"),N=n("el-switch"),r=n("el-form-item"),u=n("el-col"),y=n("el-row"),s=n("el-input"),c=n("el-divider"),R=n("el-checkbox"),q=n("el-checkbox-group"),A=n("el-form"),I=n("el-card");return M(),g("div",null,[e(k,null,{default:l(()=>[e(f,{closable:!1,"show-icon":"",title:"码支付参数说明",description:"码支付只能支持跳转登录、可同时开通多渠道、同时开启多种支付方式的情况优先级参照支付菜单排序、同时只能使用一种平台、所有的支付通知地址统一为 https://域名/api/pay/notify 将域名修改为您的域名即可！",type:"success"})]),_:1}),e(I,{style:{margin:"20px"}},{header:l(()=>[b("div",z,[a[8]||(a[8]=b("b",null,"码支付参数设置",-1)),e(w,{class:"button",text:"",onClick:S},{default:l(()=>a[7]||(a[7]=[x(" 保存设置 ")])),_:1})])]),default:l(()=>[e(A,{ref_key:"formRef",ref:d,rules:C.value,model:t,"label-width":"120px"},{default:l(()=>[e(y,null,{default:l(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:l(()=>[e(r,{label:"启用当前支付",prop:"payMpayPid"},{default:l(()=>[e(N,{modelValue:t.payMpayStatus,"onUpdate:modelValue":a[0]||(a[0]=p=>t.payMpayStatus=p),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:l(()=>[e(r,{label:"商户PID",prop:"payMpayPid"},{default:l(()=>[e(s,{modelValue:t.payMpayPid,"onUpdate:modelValue":a[1]||(a[1]=p=>t.payMpayPid=p),placeholder:"请填写商户PID",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:l(()=>[e(r,{label:"商户秘钥",prop:"payMpaySecret"},{default:l(()=>[e(s,{modelValue:t.payMpaySecret,"onUpdate:modelValue":a[2]||(a[2]=p=>t.payMpaySecret=p),placeholder:"请填写商户秘钥",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:l(()=>[e(r,{label:"支付通知地址",prop:"payMpaySecret"},{default:l(()=>[e(s,{modelValue:t.payMpayNotifyUrl,"onUpdate:modelValue":a[3]||(a[3]=p=>t.payMpayNotifyUrl=p),placeholder:"请填写支付通知地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:l(()=>[e(r,{label:"支付回调地址",prop:"payMpaySecret"},{default:l(()=>[e(s,{modelValue:t.payMpayReturnUrl,"onUpdate:modelValue":a[4]||(a[4]=p=>t.payMpayReturnUrl=p),placeholder:"请填写支付成功后的回跳地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c),e(y,null,{default:l(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:l(()=>[e(r,{label:"支付请求地址",prop:"payMpayApiPayUrl"},{default:l(()=>[e(s,{modelValue:t.payMpayApiPayUrl,"onUpdate:modelValue":a[5]||(a[5]=p=>t.payMpayApiPayUrl=p),placeholder:"请填写平台支付请求地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c),e(y,null,{default:l(()=>[e(u,{xs:24,md:24,lg:24,xl:24},{default:l(()=>[e(r,{label:"开启支付渠道",prop:"payMpayChannel"},{default:l(()=>[e(q,{modelValue:t.payMpayChannel,"onUpdate:modelValue":a[6]||(a[6]=p=>t.payMpayChannel=p),size:"small"},{default:l(()=>[(M(),g(E,null,L(P,p=>e(R,{key:p.value,border:"",label:p.value},{default:l(()=>[x(J(p.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}});typeof U=="function"&&U(F);export{F as default};
