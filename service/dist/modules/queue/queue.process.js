'use strict';var _0x7dc7a=_0x7442;(function(_0x407039,_0x4db30e){var _0x4ce693=_0x7442,_0xb9ab8=_0x407039();while(!![]){try{var _0x260d5e=parseInt(_0x4ce693(0x15e))/0x1*(parseInt(_0x4ce693(0x14a))/0x2)+-parseInt(_0x4ce693(0x161))/0x3+parseInt(_0x4ce693(0x142))/0x4+-parseInt(_0x4ce693(0x150))/0x5+-parseInt(_0x4ce693(0x160))/0x6+parseInt(_0x4ce693(0x140))/0x7*(parseInt(_0x4ce693(0x149))/0x8)+parseInt(_0x4ce693(0x15d))/0x9;if(_0x260d5e===_0x4db30e)break;else _0xb9ab8['push'](_0xb9ab8['shift']());}catch(_0x2b0a70){_0xb9ab8['push'](_0xb9ab8['shift']());}}}(_0x4bf3,0xcc1d2));function _0x7442(_0x5c9ff8,_0x46cae0){var _0x4bf3b1=_0x4bf3();return _0x7442=function(_0x7442c3,_0x465246){_0x7442c3=_0x7442c3-0x140;var _0xfd9f3f=_0x4bf3b1[_0x7442c3];return _0xfd9f3f;},_0x7442(_0x5c9ff8,_0x46cae0);}var __decorate=this&&this[_0x7dc7a(0x14d)]||function(_0x50ad6d,_0x10a940,_0x590f50,_0x4ec7ae){var _0x393851=_0x7dc7a,_0x27c471=arguments[_0x393851(0x177)],_0x3673f4=_0x27c471<0x3?_0x10a940:_0x4ec7ae===null?_0x4ec7ae=Object['getOwnPropertyDescriptor'](_0x10a940,_0x590f50):_0x4ec7ae,_0x1e9551;if(typeof Reflect===_0x393851(0x148)&&typeof Reflect['decorate']===_0x393851(0x144))_0x3673f4=Reflect[_0x393851(0x147)](_0x50ad6d,_0x10a940,_0x590f50,_0x4ec7ae);else{for(var _0x5ad15d=_0x50ad6d['length']-0x1;_0x5ad15d>=0x0;_0x5ad15d--)if(_0x1e9551=_0x50ad6d[_0x5ad15d])_0x3673f4=(_0x27c471<0x3?_0x1e9551(_0x3673f4):_0x27c471>0x3?_0x1e9551(_0x10a940,_0x590f50,_0x3673f4):_0x1e9551(_0x10a940,_0x590f50))||_0x3673f4;}return _0x27c471>0x3&&_0x3673f4&&Object['defineProperty'](_0x10a940,_0x590f50,_0x3673f4),_0x3673f4;},__metadata=this&&this[_0x7dc7a(0x145)]||function(_0x340683,_0x3eda2f){var _0x3ad248=_0x7dc7a;if(typeof Reflect==='object'&&typeof Reflect[_0x3ad248(0x159)]===_0x3ad248(0x144))return Reflect[_0x3ad248(0x159)](_0x340683,_0x3eda2f);},QueueProcessor_1;Object[_0x7dc7a(0x15b)](exports,'__esModule',{'value':!![]}),exports[_0x7dc7a(0x158)]=void 0x0;const bull_1=require('@nestjs/bull'),common_1=require('@nestjs/common'),midjourney_service_1=require(_0x7dc7a(0x14c));function _0x4bf3(){var _0x168159=['onQueueCleaned','design:paramtypes','CONCURRENCY','onQueueActive','QueueProcessor','metadata','队列恢复的时候调用','defineProperty','logger','6156072gChCPe','45896RZWJDI','design:type','7821270dauUcb','1415994yuHxKz','OnQueueProgress','log','OnQueueCleaned','OnQueueFailed','onQueuePaused','Queue\x20cleaned:\x20','OnQueueDrained','mjDraw','data','midjourneyService','design:returntype','Processor','prototype','MidjourneyService','OnQueueResumed','\x20jobs\x20of\x20type\x20','onQueueResumed','env','Queue\x20failed:\x20','OnQueuePaused','error','length','Logger','onQueueError','9380ubbHKA','message','5218492YVnIjv','onQueueProgress','function','__metadata','OnQueueActive','decorate','object','1968vcvzjC','48vQebXe','name','../midjourney/midjourney.service','__decorate',':\x20绘画失败\x20','onQueueDrained','4040910LBIpfn','onQueueFailed','handleJob','drawFailed'];_0x4bf3=function(){return _0x168159;};return _0x4bf3();}let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x3eb4ba){var _0x1621de=_0x7dc7a;this[_0x1621de(0x16b)]=_0x3eb4ba,this[_0x1621de(0x15c)]=new common_1[(_0x1621de(0x178))](QueueProcessor_1[_0x1621de(0x14b)]);}async['handleJob'](_0x545850){var _0x32c04f=_0x7dc7a;const _0x26132d=await this[_0x32c04f(0x16b)]['draw'](_0x545850[_0x32c04f(0x16a)],_0x545850['id']);return _0x26132d;}[_0x7dc7a(0x157)](_0x5ccd7f){}[_0x7dc7a(0x179)](_0x50aed4){var _0x2bbc77=_0x7dc7a;console[_0x2bbc77(0x163)]('队列发生错误',_0x50aed4);}[_0x7dc7a(0x143)](_0x231e29,_0x4c9684){var _0xedb7ab=_0x7dc7a;console[_0xedb7ab(0x163)]('队列任务的一个回调用于通知当前进度',_0x231e29['id'],_0x4c9684);}['onQueueCompleted'](_0x2449d5,_0x1248b0){}['onQueueFailed'](_0x5a6303,_0x4251f5){var _0xf0db5=_0x7dc7a;common_1['Logger'][_0xf0db5(0x176)](_0xf0db5(0x174)+_0x4251f5[_0xf0db5(0x141)]+_0xf0db5(0x14e)+_0x5a6303['id'],_0xf0db5(0x158)),this[_0xf0db5(0x16b)][_0xf0db5(0x153)](_0x5a6303[_0xf0db5(0x16a)]);}[_0x7dc7a(0x166)](){console['log']('队列暂停的时候调用');}[_0x7dc7a(0x172)](){var _0x48c0e6=_0x7dc7a;console['log'](_0x48c0e6(0x15a));}[_0x7dc7a(0x154)](_0x7c865f,_0x146dfd){var _0x194042=_0x7dc7a;common_1[_0x194042(0x178)]['log'](_0x194042(0x167)+_0x7c865f[_0x194042(0x177)]+_0x194042(0x171)+_0x146dfd+'\x20were\x20cleaned.',_0x194042(0x158));}[_0x7dc7a(0x14f)](){}};__decorate([(0x0,bull_1['Process'])({'name':_0x7dc7a(0x169),'concurrency':process[_0x7dc7a(0x173)][_0x7dc7a(0x156)]?+process[_0x7dc7a(0x173)]['CONCURRENCY']:0x3}),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[Object]),__metadata(_0x7dc7a(0x16c),Promise)],QueueProcessor[_0x7dc7a(0x16e)],_0x7dc7a(0x152),null),__decorate([(0x0,bull_1[_0x7dc7a(0x146)])(),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[Object]),__metadata(_0x7dc7a(0x16c),void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],_0x7dc7a(0x157),null),__decorate([(0x0,bull_1['OnQueueError'])(),__metadata('design:type',Function),__metadata(_0x7dc7a(0x155),[Error]),__metadata(_0x7dc7a(0x16c),void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],_0x7dc7a(0x179),null),__decorate([(0x0,bull_1[_0x7dc7a(0x162)])(),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[Object,Number]),__metadata(_0x7dc7a(0x16c),void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],_0x7dc7a(0x143),null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[Object,Object]),__metadata(_0x7dc7a(0x16c),void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],'onQueueCompleted',null),__decorate([(0x0,bull_1[_0x7dc7a(0x165)])(),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[Object,Error]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],_0x7dc7a(0x151),null),__decorate([(0x0,bull_1[_0x7dc7a(0x175)])(),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[]),__metadata(_0x7dc7a(0x16c),void 0x0)],QueueProcessor['prototype'],_0x7dc7a(0x166),null),__decorate([(0x0,bull_1[_0x7dc7a(0x170)])(),__metadata('design:type',Function),__metadata(_0x7dc7a(0x155),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],_0x7dc7a(0x172),null),__decorate([(0x0,bull_1[_0x7dc7a(0x164)])(),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[Array,String]),__metadata(_0x7dc7a(0x16c),void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],_0x7dc7a(0x154),null),__decorate([(0x0,bull_1[_0x7dc7a(0x168)])(),__metadata(_0x7dc7a(0x15f),Function),__metadata(_0x7dc7a(0x155),[]),__metadata(_0x7dc7a(0x16c),void 0x0)],QueueProcessor[_0x7dc7a(0x16e)],'onQueueDrained',null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x7dc7a(0x16d)])('MJDRAW'),__metadata(_0x7dc7a(0x155),[midjourney_service_1[_0x7dc7a(0x16f)]])],QueueProcessor),exports['QueueProcessor']=QueueProcessor;