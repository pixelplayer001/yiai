'use strict';const _0x16a324=_0x2014;(function(_0x32797b,_0x14dc8a){const _0xc6c2f1=_0x2014,_0xac1aeb=_0x32797b();while(!![]){try{const _0x355d08=-parseInt(_0xc6c2f1(0x98))/0x1+-parseInt(_0xc6c2f1(0x83))/0x2*(parseInt(_0xc6c2f1(0x9a))/0x3)+parseInt(_0xc6c2f1(0x89))/0x4+parseInt(_0xc6c2f1(0x94))/0x5+-parseInt(_0xc6c2f1(0x85))/0x6+-parseInt(_0xc6c2f1(0x7e))/0x7*(parseInt(_0xc6c2f1(0x77))/0x8)+parseInt(_0xc6c2f1(0x8d))/0x9;if(_0x355d08===_0x14dc8a)break;else _0xac1aeb['push'](_0xac1aeb['shift']());}catch(_0x271c89){_0xac1aeb['push'](_0xac1aeb['shift']());}}}(_0x7fa0,0x575af));var __decorate=this&&this[_0x16a324(0x93)]||function(_0x1dede0,_0xb9ec43,_0x30538a,_0x252108){const _0x5cc680=_0x16a324;var _0xc3725e=arguments[_0x5cc680(0x9b)],_0x2377bd=_0xc3725e<0x3?_0xb9ec43:_0x252108===null?_0x252108=Object['getOwnPropertyDescriptor'](_0xb9ec43,_0x30538a):_0x252108,_0x318278;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x5cc680(0x8f))_0x2377bd=Reflect['decorate'](_0x1dede0,_0xb9ec43,_0x30538a,_0x252108);else{for(var _0x3f4fa4=_0x1dede0[_0x5cc680(0x9b)]-0x1;_0x3f4fa4>=0x0;_0x3f4fa4--)if(_0x318278=_0x1dede0[_0x3f4fa4])_0x2377bd=(_0xc3725e<0x3?_0x318278(_0x2377bd):_0xc3725e>0x3?_0x318278(_0xb9ec43,_0x30538a,_0x2377bd):_0x318278(_0xb9ec43,_0x30538a))||_0x2377bd;}return _0xc3725e>0x3&&_0x2377bd&&Object['defineProperty'](_0xb9ec43,_0x30538a,_0x2377bd),_0x2377bd;},__metadata=this&&this[_0x16a324(0x81)]||function(_0x57db3d,_0x564f4b){const _0x45d1ec=_0x16a324;if(typeof Reflect===_0x45d1ec(0x9d)&&typeof Reflect['metadata']===_0x45d1ec(0x8f))return Reflect[_0x45d1ec(0x7a)](_0x57db3d,_0x564f4b);},__param=this&&this[_0x16a324(0xa4)]||function(_0x57518e,_0x39fe2f){return function(_0x16410a,_0x6a97b6){_0x39fe2f(_0x16410a,_0x6a97b6,_0x57518e);};};function _0x7fa0(){const _0x4efdb6=['1967ByRIef','design:type','EVERY_5_MINUTES','__metadata','TaskService','2RIGjIJ','prototype','3673638lhntQH','会员已到期、清空所有余额并移除会员身份！','UserBalanceEntity','Repository','671076ggeKXu','design:returntype','GlobalConfigService','getWechatAccessToken','10540269zXkkHR','LessThanOrEqual','function','EVERY_HOUR','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','Cron','__decorate','805765HwOdfG','Injectable','modelsService','design:paramtypes','311302woZnZO','Logger','56670NmXBIA','length','CronExpression','object','@nestjs/common','../models/models.service','ModelsService','userBalanceEntity','defineProperty','globalConfigService','__param','__esModule','5688MnYaTl','debug','./../globalConfig/globalConfig.service','metadata','then','@nestjs/schedule','handleCron'];_0x7fa0=function(){return _0x4efdb6;};return _0x7fa0();}Object[_0x16a324(0xa2)](exports,_0x16a324(0x76),{'value':!![]}),exports[_0x16a324(0x82)]=void 0x0;const globalConfig_service_1=require(_0x16a324(0x79)),common_1=require(_0x16a324(0x9e)),schedule_1=require(_0x16a324(0x7c)),userBalance_entity_1=require('../userBalance/userBalance.entity'),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require('typeorm'),models_service_1=require(_0x16a324(0x9f));function _0x2014(_0x566651,_0x5839ea){const _0x7fa09b=_0x7fa0();return _0x2014=function(_0x201494,_0x4a2331){_0x201494=_0x201494-0x76;let _0x511392=_0x7fa09b[_0x201494];return _0x511392;},_0x2014(_0x566651,_0x5839ea);}let TaskService=class TaskService{constructor(_0x5bcc79,_0x368140,_0x543ab4){const _0x2b4281=_0x16a324;this[_0x2b4281(0xa1)]=_0x5bcc79,this[_0x2b4281(0xa3)]=_0x368140,this[_0x2b4281(0x96)]=_0x543ab4;}['handleCron'](){const _0x21c5af=_0x16a324;common_1[_0x21c5af(0x99)]['debug'](_0x21c5af(0x91),'TaskService'),this['globalConfigService'][_0x21c5af(0x8c)]();}async['checkUserMemerExpire'](){const _0x1f0e22=_0x16a324,_0x3a6c76=await this[_0x1f0e22(0xa1)]['find']({'where':{'expirationTime':(0x0,typeorm_2[_0x1f0e22(0x8e)])(new Date())}});if(!_0x3a6c76||!_0x3a6c76['length'])return;_0x3a6c76['forEach'](_0x8ee754=>{const _0x265380=_0x1f0e22;this[_0x265380(0xa1)]['update']({'id':_0x8ee754['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x265380(0x7b)](_0x46feff=>{const _0x1ef3e8=_0x265380;common_1['Logger'][_0x1ef3e8(0x78)](_0x8ee754['id']+_0x1ef3e8(0x86),_0x1ef3e8(0x82));});});}};__decorate([(0x0,schedule_1[_0x16a324(0x92)])(schedule_1[_0x16a324(0x9c)][_0x16a324(0x90)]),__metadata(_0x16a324(0x7f),Function),__metadata(_0x16a324(0x97),[]),__metadata('design:returntype',void 0x0)],TaskService[_0x16a324(0x84)],_0x16a324(0x7d),null),__decorate([(0x0,schedule_1[_0x16a324(0x92)])(schedule_1[_0x16a324(0x9c)][_0x16a324(0x80)]),__metadata('design:type',Function),__metadata(_0x16a324(0x97),[]),__metadata(_0x16a324(0x8a),Promise)],TaskService['prototype'],'checkUserMemerExpire',null),TaskService=__decorate([(0x0,common_1[_0x16a324(0x95)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(userBalance_entity_1[_0x16a324(0x87)])),__metadata(_0x16a324(0x97),[typeorm_2[_0x16a324(0x88)],globalConfig_service_1[_0x16a324(0x8b)],models_service_1[_0x16a324(0xa0)]])],TaskService),exports[_0x16a324(0x82)]=TaskService;