'use strict';const _0xdd540=_0xb969;(function(_0x4b52c8,_0x4c4215){const _0x4dccec=_0xb969,_0x125ef0=_0x4b52c8();while(!![]){try{const _0x52a4fa=parseInt(_0x4dccec(0x1aa))/0x1+-parseInt(_0x4dccec(0x1c9))/0x2+-parseInt(_0x4dccec(0x1b8))/0x3*(parseInt(_0x4dccec(0x1c2))/0x4)+-parseInt(_0x4dccec(0x1ca))/0x5+parseInt(_0x4dccec(0x1d1))/0x6*(-parseInt(_0x4dccec(0x196))/0x7)+parseInt(_0x4dccec(0x1b1))/0x8+parseInt(_0x4dccec(0x1a3))/0x9;if(_0x52a4fa===_0x4c4215)break;else _0x125ef0['push'](_0x125ef0['shift']());}catch(_0x455f4b){_0x125ef0['push'](_0x125ef0['shift']());}}}(_0x5d32,0xf0213));function _0xb969(_0x31d3be,_0x121117){const _0x5d322e=_0x5d32();return _0xb969=function(_0xb9694f,_0x437641){_0xb9694f=_0xb9694f-0x179;let _0xa454f5=_0x5d322e[_0xb9694f];return _0xa454f5;},_0xb969(_0x31d3be,_0x121117);}var __decorate=this&&this[_0xdd540(0x17a)]||function(_0x4bb3dc,_0x935e02,_0x126614,_0x46b477){const _0x250f0d=_0xdd540;var _0x104556=arguments['length'],_0x5694fb=_0x104556<0x3?_0x935e02:_0x46b477===null?_0x46b477=Object[_0x250f0d(0x1d6)](_0x935e02,_0x126614):_0x46b477,_0x3c2871;if(typeof Reflect===_0x250f0d(0x1c8)&&typeof Reflect['decorate']===_0x250f0d(0x18d))_0x5694fb=Reflect['decorate'](_0x4bb3dc,_0x935e02,_0x126614,_0x46b477);else{for(var _0xfbbc6a=_0x4bb3dc[_0x250f0d(0x179)]-0x1;_0xfbbc6a>=0x0;_0xfbbc6a--)if(_0x3c2871=_0x4bb3dc[_0xfbbc6a])_0x5694fb=(_0x104556<0x3?_0x3c2871(_0x5694fb):_0x104556>0x3?_0x3c2871(_0x935e02,_0x126614,_0x5694fb):_0x3c2871(_0x935e02,_0x126614))||_0x5694fb;}return _0x104556>0x3&&_0x5694fb&&Object['defineProperty'](_0x935e02,_0x126614,_0x5694fb),_0x5694fb;},__metadata=this&&this[_0xdd540(0x1ba)]||function(_0x198565,_0x253669){const _0x39c763=_0xdd540;if(typeof Reflect===_0x39c763(0x1c8)&&typeof Reflect[_0x39c763(0x1d5)]===_0x39c763(0x18d))return Reflect[_0x39c763(0x1d5)](_0x198565,_0x253669);},__param=this&&this[_0xdd540(0x180)]||function(_0x2401fe,_0x3a0ba3){return function(_0x1d8d38,_0x677639){_0x3a0ba3(_0x1d8d38,_0x677639,_0x2401fe);};};function _0x5d32(){const _0x5a84dd=['UseGuards','sceneStr:\x20','CLICK','扫码绑定轮询查询','8NpaodG','Get','unsubscribe','timestamp','公众号通知接口POST','ApiOperation','object','3159110gGcZsg','3195500wSwLcg','Req','msgtype','qrscene_','获取登录二维码sceneStr','official','VIEW','18ivFHXy','获取登录跳转地址','getQRCode','Query','metadata','getOwnPropertyDescriptor','ISDEV','length','__decorate','Post','log','text','getQRSceneStr','./dto/getQrSceneStr.dto','__param','公众号静默登录','officialScanLoginText','获取注册配置','扫码登录轮询查询','scan','fromusername','env','officialBindAccountText','includes','officialService','prototype','event','function','design:returntype','defineProperty','officialSubscribeText','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','success','getQRSceneStrByBind','loginByCode','getRedirectUrl','2147523TbCQsM','bindWxBySceneStr','design:type','status','Res','send','scanBindWx','获取绑定二维码的sceneStr','OfficialController','Controller','./official.service','aotoPlay','notify','36548055LqDdUp','notifyPost','@nestjs/common','GetQrCodeDto','./dto/getQrCode.dto','design:paramtypes','获取二维码','1386028eKVdug','subscribe','code','url','TRUE','eventkey','__esModule','1548576YSIawQ','getJsapiTicket','sceneStr','genXmlMsgByConfig','split','Body','getQRCodeTicket','2276853VrQKlK','xml:\x20','__metadata','loginBySceneStr','genXmlMsg','content'];_0x5d32=function(){return _0x5a84dd;};return _0x5d32();}Object[_0xdd540(0x18f)](exports,_0xdd540(0x1b0),{'value':!![]}),exports[_0xdd540(0x19e)]=void 0x0;const common_1=require(_0xdd540(0x1a5)),swagger_1=require('@nestjs/swagger'),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0xdd540(0x1a0)),getQrCode_dto_1=require(_0xdd540(0x1a7)),getQrSceneStr_dto_1=require(_0xdd540(0x17f));let OfficialController=class OfficialController{constructor(_0x142ea3){const _0x547bb2=_0xdd540;this[_0x547bb2(0x18a)]=_0x142ea3;}async[_0xdd540(0x1a2)](_0x452394,_0x57565a,_0x2cf8cf){const _0x4d680d=_0xdd540;console['log']('get\x20通知>>>',_0x57565a,_0x2cf8cf);const _0x8e5ef9=await this[_0x4d680d(0x18a)]['verify'](_0x57565a['signature'],_0x57565a['nonce'],_0x57565a[_0x4d680d(0x1c5)]);return _0x8e5ef9?_0x57565a['echostr']:'';}async['notifyPost'](_0x1c74c3,_0x48eab5,_0x4030d5,_0x3fe5b7){const _0x2fd7ee=_0xdd540,{xml:_0x3d3390}=_0x4030d5;console['log'](_0x2fd7ee(0x1b9),_0x3d3390);if(_0x3d3390[_0x2fd7ee(0x1cc)][0x0]==_0x2fd7ee(0x18c)){if(_0x3d3390['event'][0x0]==_0x2fd7ee(0x1d0)||_0x3d3390[_0x2fd7ee(0x18c)][0x0]==_0x2fd7ee(0x1c0))return _0x3fe5b7[_0x2fd7ee(0x199)](0xc8)[_0x2fd7ee(0x19b)]('');if(_0x3d3390[_0x2fd7ee(0x18c)][0x0]=='SCAN'){console[_0x2fd7ee(0x17c)]('扫码');const _0x64d068=_0x3d3390['eventkey'][0x0];if(_0x64d068[_0x2fd7ee(0x189)]('/')){this[_0x2fd7ee(0x18a)][_0x2fd7ee(0x19c)](_0x3d3390[_0x2fd7ee(0x186)][0x0],_0x64d068);const _0x468a80=await this['officialService']['genXmlMsgByConfig'](_0x3d3390,_0x2fd7ee(0x188));return _0x3fe5b7[_0x2fd7ee(0x199)](0xc8)['send'](_0x468a80);}this[_0x2fd7ee(0x18a)][_0x2fd7ee(0x185)](_0x3d3390[_0x2fd7ee(0x186)][0x0],_0x64d068);const _0x59f0c4=await this[_0x2fd7ee(0x18a)][_0x2fd7ee(0x1b4)](_0x3d3390,_0x2fd7ee(0x182));return _0x3fe5b7[_0x2fd7ee(0x199)](0xc8)[_0x2fd7ee(0x19b)](_0x59f0c4);}if(_0x3d3390['event'][0x0]==_0x2fd7ee(0x1ab)){console['log']('订阅',_0x3d3390[_0x2fd7ee(0x1af)][0x0]);const _0x5192c8=_0x3d3390[_0x2fd7ee(0x1af)][0x0][_0x2fd7ee(0x1b5)](_0x2fd7ee(0x1cd))[0x1];console[_0x2fd7ee(0x17c)](_0x2fd7ee(0x1bf),_0x5192c8);if(!_0x5192c8){const _0x18aad2=await this['officialService'][_0x2fd7ee(0x1b4)](_0x3d3390,_0x2fd7ee(0x190));return _0x3fe5b7[_0x2fd7ee(0x199)](0xc8)['send'](_0x18aad2);}if(_0x5192c8[_0x2fd7ee(0x189)]('/')){this['officialService'][_0x2fd7ee(0x19c)](_0x3d3390['fromusername'][0x0],_0x5192c8);const _0x45b65a=await this[_0x2fd7ee(0x18a)][_0x2fd7ee(0x1b4)](_0x3d3390,_0x2fd7ee(0x188));return _0x3fe5b7[_0x2fd7ee(0x199)](0xc8)[_0x2fd7ee(0x19b)](_0x45b65a);}this['officialService'][_0x2fd7ee(0x185)](_0x3d3390[_0x2fd7ee(0x186)][0x0],_0x5192c8);const _0x331f24=await this['officialService'][_0x2fd7ee(0x1b4)](_0x3d3390,'officialSubscribeText');return _0x3fe5b7['status'](0xc8)[_0x2fd7ee(0x19b)](_0x331f24);}if(_0x3d3390[_0x2fd7ee(0x18c)][0x0]==_0x2fd7ee(0x1c4))return _0x3fe5b7[_0x2fd7ee(0x199)](0xc8)[_0x2fd7ee(0x19b)]('');}if(_0x3d3390['msgtype'][0x0]==_0x2fd7ee(0x17d)){const _0x595968=await this[_0x2fd7ee(0x18a)][_0x2fd7ee(0x1a1)](_0x3d3390[_0x2fd7ee(0x1bd)][0x0]),_0x7e8b9a=await this[_0x2fd7ee(0x18a)][_0x2fd7ee(0x1bc)](_0x3d3390,_0x595968);return _0x3fe5b7[_0x2fd7ee(0x199)](0xc8)['send'](_0x7e8b9a);}return _0x2fd7ee(0x192);}async[_0xdd540(0x17e)](_0x37900c){const _0x27d893=_0xdd540;return this[_0x27d893(0x18a)][_0x27d893(0x17e)](_0x37900c);}async['getQRSceneStrByBind'](_0x272ea8){const _0x126ca4=_0xdd540;return this['officialService'][_0x126ca4(0x193)](_0x272ea8);}async['getQRCode'](_0x52349d){const _0x56dc94=_0xdd540;if(process[_0x56dc94(0x187)][_0x56dc94(0x1d7)]===_0x56dc94(0x1ae))return'';const _0x5e0879=await this[_0x56dc94(0x18a)][_0x56dc94(0x1b7)](_0x52349d[_0x56dc94(0x1b3)]);return _0x56dc94(0x191)+encodeURIComponent(_0x5e0879);}async[_0xdd540(0x1bb)](_0x22982e,_0x175516){const _0x452dc4=_0xdd540;return this['officialService'][_0x452dc4(0x1bb)](_0x22982e,_0x175516['sceneStr']);}async[_0xdd540(0x197)](_0x50cbe8,_0x59eb94){const _0x42a3bd=_0xdd540;return this[_0x42a3bd(0x18a)]['bindWxBySceneStr'](_0x50cbe8,_0x59eb94[_0x42a3bd(0x1b3)]);}async[_0xdd540(0x195)](_0x7b5ea6){const _0x1bfb74=_0xdd540;return this[_0x1bfb74(0x18a)]['getRedirectUrl'](_0x7b5ea6[_0x1bfb74(0x1ad)]);}async[_0xdd540(0x1b2)](_0x25b608){const _0x359e39=_0xdd540;return this[_0x359e39(0x18a)][_0x359e39(0x1b2)](_0x25b608[_0x359e39(0x1ad)]);}async[_0xdd540(0x194)](_0x5b711f,_0x14357d){const _0xc3eefb=_0xdd540;return this[_0xc3eefb(0x18a)][_0xc3eefb(0x194)](_0x5b711f,_0x14357d[_0xc3eefb(0x1ac)]);}};__decorate([(0x0,common_1[_0xdd540(0x1c3)])('notify'),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0xdd540(0x1cb)])()),__param(0x1,(0x0,common_1[_0xdd540(0x1d4)])()),__param(0x2,(0x0,common_1[_0xdd540(0x1b6)])()),__metadata(_0xdd540(0x198),Function),__metadata(_0xdd540(0x1a8),[Object,Object,Object]),__metadata(_0xdd540(0x18e),Promise)],OfficialController['prototype'],_0xdd540(0x1a2),null),__decorate([(0x0,common_1[_0xdd540(0x17b)])(_0xdd540(0x1a2)),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x1c6)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0xdd540(0x1b6)])()),__param(0x3,(0x0,common_1[_0xdd540(0x19a)])()),__metadata(_0xdd540(0x198),Function),__metadata('design:paramtypes',[Object,Object,Object,Object]),__metadata(_0xdd540(0x18e),Promise)],OfficialController[_0xdd540(0x18b)],_0xdd540(0x1a4),null),__decorate([(0x0,common_1[_0xdd540(0x17b)])(_0xdd540(0x17e)),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x1ce)}),__param(0x0,(0x0,common_1[_0xdd540(0x1b6)])()),__metadata(_0xdd540(0x198),Function),__metadata(_0xdd540(0x1a8),[getQrSceneStr_dto_1['GetQrSceneStrDto']]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0xdd540(0x17e),null),__decorate([(0x0,common_1[_0xdd540(0x17b)])(_0xdd540(0x193)),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x19d)}),(0x0,common_1[_0xdd540(0x1be)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0xdd540(0x1cb)])()),__metadata(_0xdd540(0x198),Function),__metadata('design:paramtypes',[Object]),__metadata(_0xdd540(0x18e),Promise)],OfficialController[_0xdd540(0x18b)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0xdd540(0x1c3)])('getQRCode'),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x1a9)}),__param(0x0,(0x0,common_1[_0xdd540(0x1d4)])()),__metadata(_0xdd540(0x198),Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0xdd540(0x1a6)]]),__metadata(_0xdd540(0x18e),Promise)],OfficialController['prototype'],_0xdd540(0x1d3),null),__decorate([(0x0,common_1[_0xdd540(0x17b)])('loginBySceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':_0xdd540(0x184)}),__param(0x0,(0x0,common_1[_0xdd540(0x1cb)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0xdd540(0x198),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0xdd540(0x18e),Promise)],OfficialController[_0xdd540(0x18b)],_0xdd540(0x1bb),null),__decorate([(0x0,common_1[_0xdd540(0x17b)])(_0xdd540(0x197)),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x1c1)}),(0x0,common_1[_0xdd540(0x1be)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0xdd540(0x1cb)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0xdd540(0x198),Function),__metadata(_0xdd540(0x1a8),[Object,getQrCode_dto_1[_0xdd540(0x1a6)]]),__metadata('design:returntype',Promise)],OfficialController['prototype'],'bindWxBySceneStr',null),__decorate([(0x0,common_1[_0xdd540(0x17b)])(_0xdd540(0x195)),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x1d2)}),__param(0x0,(0x0,common_1[_0xdd540(0x1b6)])()),__metadata(_0xdd540(0x198),Function),__metadata(_0xdd540(0x1a8),[Object]),__metadata(_0xdd540(0x18e),Promise)],OfficialController[_0xdd540(0x18b)],'getRedirectUrl',null),__decorate([(0x0,common_1[_0xdd540(0x17b)])(_0xdd540(0x1b2)),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x183)}),__param(0x0,(0x0,common_1[_0xdd540(0x1b6)])()),__metadata(_0xdd540(0x198),Function),__metadata(_0xdd540(0x1a8),[Object]),__metadata(_0xdd540(0x18e),Promise)],OfficialController[_0xdd540(0x18b)],_0xdd540(0x1b2),null),__decorate([(0x0,common_1[_0xdd540(0x17b)])(_0xdd540(0x194)),(0x0,swagger_1[_0xdd540(0x1c7)])({'summary':_0xdd540(0x181)}),__param(0x0,(0x0,common_1[_0xdd540(0x1cb)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0xdd540(0x1a8),[Object,Object]),__metadata(_0xdd540(0x18e),Promise)],OfficialController[_0xdd540(0x18b)],_0xdd540(0x194),null),OfficialController=__decorate([(0x0,swagger_1['ApiTags'])(_0xdd540(0x1cf)),(0x0,common_1[_0xdd540(0x19f)])(_0xdd540(0x1cf)),__metadata(_0xdd540(0x1a8),[official_service_1['OfficialService']])],OfficialController),exports[_0xdd540(0x19e)]=OfficialController;