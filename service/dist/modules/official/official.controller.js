'use strict';const _0x45b687=_0x4a3d;(function(_0x14f2cf,_0xffa5c9){const _0x297f1a=_0x4a3d,_0x4dfbb4=_0x14f2cf();while(!![]){try{const _0x2bbe6c=-parseInt(_0x297f1a(0x162))/0x1*(-parseInt(_0x297f1a(0x144))/0x2)+-parseInt(_0x297f1a(0x14d))/0x3*(parseInt(_0x297f1a(0x16c))/0x4)+parseInt(_0x297f1a(0x149))/0x5*(parseInt(_0x297f1a(0x164))/0x6)+-parseInt(_0x297f1a(0x134))/0x7+parseInt(_0x297f1a(0x12d))/0x8*(parseInt(_0x297f1a(0x132))/0x9)+parseInt(_0x297f1a(0x13e))/0xa*(parseInt(_0x297f1a(0x141))/0xb)+-parseInt(_0x297f1a(0x169))/0xc;if(_0x2bbe6c===_0xffa5c9)break;else _0x4dfbb4['push'](_0x4dfbb4['shift']());}catch(_0x4b8ee2){_0x4dfbb4['push'](_0x4dfbb4['shift']());}}}(_0x4493,0xacb41));var __decorate=this&&this[_0x45b687(0x115)]||function(_0x5beaf5,_0x20f910,_0x4932df,_0x31c049){const _0x1cc6c6=_0x45b687;var _0x1c43a2=arguments[_0x1cc6c6(0x12a)],_0x30210a=_0x1c43a2<0x3?_0x20f910:_0x31c049===null?_0x31c049=Object[_0x1cc6c6(0x127)](_0x20f910,_0x4932df):_0x31c049,_0xf17e04;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x1cc6c6(0x14a))_0x30210a=Reflect[_0x1cc6c6(0x173)](_0x5beaf5,_0x20f910,_0x4932df,_0x31c049);else{for(var _0x2582c7=_0x5beaf5[_0x1cc6c6(0x12a)]-0x1;_0x2582c7>=0x0;_0x2582c7--)if(_0xf17e04=_0x5beaf5[_0x2582c7])_0x30210a=(_0x1c43a2<0x3?_0xf17e04(_0x30210a):_0x1c43a2>0x3?_0xf17e04(_0x20f910,_0x4932df,_0x30210a):_0xf17e04(_0x20f910,_0x4932df))||_0x30210a;}return _0x1c43a2>0x3&&_0x30210a&&Object[_0x1cc6c6(0x14c)](_0x20f910,_0x4932df,_0x30210a),_0x30210a;},__metadata=this&&this[_0x45b687(0x130)]||function(_0x25cfb3,_0x3c2b00){const _0xee54c6=_0x45b687;if(typeof Reflect===_0xee54c6(0x153)&&typeof Reflect[_0xee54c6(0x120)]===_0xee54c6(0x14a))return Reflect[_0xee54c6(0x120)](_0x25cfb3,_0x3c2b00);},__param=this&&this[_0x45b687(0x118)]||function(_0x15cc78,_0x592871){return function(_0x170af6,_0x15fce1){_0x592871(_0x170af6,_0x15fce1,_0x15cc78);};};Object[_0x45b687(0x14c)](exports,_0x45b687(0x170),{'value':!![]}),exports[_0x45b687(0x168)]=void 0x0;const common_1=require(_0x45b687(0x136)),swagger_1=require(_0x45b687(0x117)),jwtAuth_guard_1=require(_0x45b687(0x129)),official_service_1=require('./official.service'),getQrCode_dto_1=require(_0x45b687(0x11d)),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto');function _0x4493(){const _0x45dfed=['ApiTags','scanBindWx','__metadata','official','18BedXYH','send','5008136Bkckim','公众号通知接口GET','@nestjs/common','event','ISDEV','GetQrSceneStrDto','获取登录二维码sceneStr','JwtAuthGuard','Req','echostr','490GNrOAP','subscribe','loginBySceneStr','285758PYfIYh','Query','公众号通知接口POST','91472WDZmYX','split','sceneStr','GetQrCodeDto','Res','3634630tHCaMS','function','UseGuards','defineProperty','171cfzdvB','nonce','status','qrscene_','getJsapiTicket','unsubscribe','object','fromusername','ApiOperation','eventkey','officialService','content','verify','xml:\x20','includes','getQRCode','TRUE','text','msgtype','Post','loginByCode','7ahEHno','officialBindAccountText','6WNgEXx','success','扫码绑定轮询查询','log','OfficialController','24603180kgehPE','officialScanLoginText','genXmlMsgByConfig','2064CgrzOr','getQRSceneStrByBind','design:type','获取登录跳转地址','__esModule','notify','url','decorate','__decorate','prototype','@nestjs/swagger','__param','getQRSceneStr','Body','design:paramtypes','获取注册配置','./dto/getQrCode.dto','SCAN','bindWxBySceneStr','metadata','officialSubscribeText','design:returntype','扫码登录轮询查询','notifyPost','VIEW','env','getOwnPropertyDescriptor','getRedirectUrl','../../common/auth/jwtAuth.guard','length','getQRCodeTicket','获取二维码','4730072zAPYwh'];_0x4493=function(){return _0x45dfed;};return _0x4493();}let OfficialController=class OfficialController{constructor(_0x1006b1){this['officialService']=_0x1006b1;}async['notify'](_0x19647f,_0x309cdd,_0x1b69a8){const _0x40e427=_0x45b687;console[_0x40e427(0x167)]('get\x20通知>>>',_0x309cdd,_0x1b69a8);const _0x5af1b1=await this[_0x40e427(0x157)][_0x40e427(0x159)](_0x309cdd['signature'],_0x309cdd[_0x40e427(0x14e)],_0x309cdd['timestamp']);return _0x5af1b1?_0x309cdd[_0x40e427(0x13d)]:'';}async[_0x45b687(0x124)](_0x2b8ac7,_0x366799,_0x2e7063,_0x868c9){const _0x5170e2=_0x45b687,{xml:_0x25a178}=_0x2e7063;console[_0x5170e2(0x167)](_0x5170e2(0x15a),_0x25a178);if(_0x25a178['msgtype'][0x0]=='event'){if(_0x25a178[_0x5170e2(0x137)][0x0]==_0x5170e2(0x125)||_0x25a178[_0x5170e2(0x137)][0x0]=='CLICK')return _0x868c9['status'](0xc8)[_0x5170e2(0x133)]('');if(_0x25a178[_0x5170e2(0x137)][0x0]==_0x5170e2(0x11e)){console[_0x5170e2(0x167)]('扫码');const _0x44b096=_0x25a178[_0x5170e2(0x156)][0x0];if(_0x44b096[_0x5170e2(0x15b)]('/')){this[_0x5170e2(0x157)]['scanBindWx'](_0x25a178['fromusername'][0x0],_0x44b096);const _0x361644=await this[_0x5170e2(0x157)][_0x5170e2(0x16b)](_0x25a178,_0x5170e2(0x163));return _0x868c9['status'](0xc8)[_0x5170e2(0x133)](_0x361644);}this['officialService']['scan'](_0x25a178[_0x5170e2(0x154)][0x0],_0x44b096);const _0x21557f=await this[_0x5170e2(0x157)][_0x5170e2(0x16b)](_0x25a178,_0x5170e2(0x16a));return _0x868c9[_0x5170e2(0x14f)](0xc8)[_0x5170e2(0x133)](_0x21557f);}if(_0x25a178[_0x5170e2(0x137)][0x0]==_0x5170e2(0x13f)){console['log']('订阅',_0x25a178[_0x5170e2(0x156)][0x0]);const _0x3ef3c9=_0x25a178[_0x5170e2(0x156)][0x0][_0x5170e2(0x145)](_0x5170e2(0x150))[0x1];console[_0x5170e2(0x167)]('sceneStr:\x20',_0x3ef3c9);if(!_0x3ef3c9){const _0x2cc5d3=await this[_0x5170e2(0x157)][_0x5170e2(0x16b)](_0x25a178,_0x5170e2(0x121));return _0x868c9['status'](0xc8)[_0x5170e2(0x133)](_0x2cc5d3);}if(_0x3ef3c9[_0x5170e2(0x15b)]('/')){this[_0x5170e2(0x157)][_0x5170e2(0x12f)](_0x25a178[_0x5170e2(0x154)][0x0],_0x3ef3c9);const _0x18f986=await this[_0x5170e2(0x157)][_0x5170e2(0x16b)](_0x25a178,_0x5170e2(0x163));return _0x868c9[_0x5170e2(0x14f)](0xc8)[_0x5170e2(0x133)](_0x18f986);}this[_0x5170e2(0x157)]['scan'](_0x25a178[_0x5170e2(0x154)][0x0],_0x3ef3c9);const _0x1b5246=await this[_0x5170e2(0x157)][_0x5170e2(0x16b)](_0x25a178,_0x5170e2(0x121));return _0x868c9[_0x5170e2(0x14f)](0xc8)['send'](_0x1b5246);}if(_0x25a178[_0x5170e2(0x137)][0x0]==_0x5170e2(0x152))return _0x868c9[_0x5170e2(0x14f)](0xc8)[_0x5170e2(0x133)]('');}if(_0x25a178[_0x5170e2(0x15f)][0x0]==_0x5170e2(0x15e)){const _0x39be33=await this['officialService']['aotoPlay'](_0x25a178[_0x5170e2(0x158)][0x0]),_0x1328fd=await this[_0x5170e2(0x157)]['genXmlMsg'](_0x25a178,_0x39be33);return _0x868c9[_0x5170e2(0x14f)](0xc8)[_0x5170e2(0x133)](_0x1328fd);}return _0x5170e2(0x165);}async['getQRSceneStr'](_0x214e59){const _0x307bf8=_0x45b687;return this[_0x307bf8(0x157)][_0x307bf8(0x119)](_0x214e59);}async[_0x45b687(0x16d)](_0x181882){const _0x2f8080=_0x45b687;return this[_0x2f8080(0x157)][_0x2f8080(0x16d)](_0x181882);}async[_0x45b687(0x15c)](_0x13ff47){const _0x2fc68a=_0x45b687;if(process[_0x2fc68a(0x126)][_0x2fc68a(0x138)]===_0x2fc68a(0x15d))return'';const _0x3ce5cb=await this['officialService'][_0x2fc68a(0x12b)](_0x13ff47['sceneStr']);return'https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket='+encodeURIComponent(_0x3ce5cb);}async[_0x45b687(0x140)](_0x3a9e62,_0xce772c){const _0x37785d=_0x45b687;return this[_0x37785d(0x157)]['loginBySceneStr'](_0x3a9e62,_0xce772c[_0x37785d(0x146)]);}async[_0x45b687(0x11f)](_0x13b990,_0x1e88c0){const _0x4e21ff=_0x45b687;return this[_0x4e21ff(0x157)]['bindWxBySceneStr'](_0x13b990,_0x1e88c0[_0x4e21ff(0x146)]);}async[_0x45b687(0x128)](_0x295dd2){const _0x4a541f=_0x45b687;return this['officialService'][_0x4a541f(0x128)](_0x295dd2[_0x4a541f(0x172)]);}async[_0x45b687(0x151)](_0x48f44a){const _0x4bba9b=_0x45b687;return this[_0x4bba9b(0x157)]['getJsapiTicket'](_0x48f44a[_0x4bba9b(0x172)]);}async[_0x45b687(0x161)](_0x2753bd,_0x1fd9be){const _0x543142=_0x45b687;return this[_0x543142(0x157)]['loginByCode'](_0x2753bd,_0x1fd9be['code']);}};function _0x4a3d(_0x2894e7,_0xa4b324){const _0x449320=_0x4493();return _0x4a3d=function(_0x4a3dd6,_0x55229e){_0x4a3dd6=_0x4a3dd6-0x115;let _0x470956=_0x449320[_0x4a3dd6];return _0x470956;},_0x4a3d(_0x2894e7,_0xa4b324);}__decorate([(0x0,common_1['Get'])(_0x45b687(0x171)),(0x0,swagger_1[_0x45b687(0x155)])({'summary':_0x45b687(0x135)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x45b687(0x11a)])()),__metadata(_0x45b687(0x16e),Function),__metadata(_0x45b687(0x11b),[Object,Object,Object]),__metadata(_0x45b687(0x122),Promise)],OfficialController['prototype'],_0x45b687(0x171),null),__decorate([(0x0,common_1[_0x45b687(0x160)])(_0x45b687(0x171)),(0x0,swagger_1['ApiOperation'])({'summary':_0x45b687(0x143)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x45b687(0x142)])()),__param(0x2,(0x0,common_1[_0x45b687(0x11a)])()),__param(0x3,(0x0,common_1[_0x45b687(0x148)])()),__metadata(_0x45b687(0x16e),Function),__metadata('design:paramtypes',[Object,Object,Object,Object]),__metadata(_0x45b687(0x122),Promise)],OfficialController[_0x45b687(0x116)],_0x45b687(0x124),null),__decorate([(0x0,common_1[_0x45b687(0x160)])(_0x45b687(0x119)),(0x0,swagger_1[_0x45b687(0x155)])({'summary':_0x45b687(0x13a)}),__param(0x0,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x45b687(0x11b),[getQrSceneStr_dto_1[_0x45b687(0x139)]]),__metadata(_0x45b687(0x122),Promise)],OfficialController[_0x45b687(0x116)],'getQRSceneStr',null),__decorate([(0x0,common_1['Post'])(_0x45b687(0x16d)),(0x0,swagger_1[_0x45b687(0x155)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x45b687(0x14b)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x45b687(0x13c)])()),__metadata(_0x45b687(0x16e),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x45b687(0x122),Promise)],OfficialController[_0x45b687(0x116)],_0x45b687(0x16d),null),__decorate([(0x0,common_1['Get'])(_0x45b687(0x15c)),(0x0,swagger_1[_0x45b687(0x155)])({'summary':_0x45b687(0x12c)}),__param(0x0,(0x0,common_1[_0x45b687(0x142)])()),__metadata(_0x45b687(0x16e),Function),__metadata('design:paramtypes',[getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x45b687(0x122),Promise)],OfficialController[_0x45b687(0x116)],_0x45b687(0x15c),null),__decorate([(0x0,common_1[_0x45b687(0x160)])(_0x45b687(0x140)),(0x0,swagger_1['ApiOperation'])({'summary':_0x45b687(0x123)}),__param(0x0,(0x0,common_1[_0x45b687(0x13c)])()),__param(0x1,(0x0,common_1[_0x45b687(0x11a)])()),__metadata(_0x45b687(0x16e),Function),__metadata(_0x45b687(0x11b),[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x45b687(0x122),Promise)],OfficialController['prototype'],_0x45b687(0x140),null),__decorate([(0x0,common_1['Post'])(_0x45b687(0x11f)),(0x0,swagger_1[_0x45b687(0x155)])({'summary':_0x45b687(0x166)}),(0x0,common_1[_0x45b687(0x14b)])(jwtAuth_guard_1[_0x45b687(0x13b)]),__param(0x0,(0x0,common_1[_0x45b687(0x13c)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x45b687(0x16e),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x45b687(0x147)]]),__metadata(_0x45b687(0x122),Promise)],OfficialController[_0x45b687(0x116)],_0x45b687(0x11f),null),__decorate([(0x0,common_1[_0x45b687(0x160)])(_0x45b687(0x128)),(0x0,swagger_1['ApiOperation'])({'summary':_0x45b687(0x16f)}),__param(0x0,(0x0,common_1[_0x45b687(0x11a)])()),__metadata(_0x45b687(0x16e),Function),__metadata(_0x45b687(0x11b),[Object]),__metadata(_0x45b687(0x122),Promise)],OfficialController[_0x45b687(0x116)],_0x45b687(0x128),null),__decorate([(0x0,common_1[_0x45b687(0x160)])(_0x45b687(0x151)),(0x0,swagger_1[_0x45b687(0x155)])({'summary':_0x45b687(0x11c)}),__param(0x0,(0x0,common_1[_0x45b687(0x11a)])()),__metadata(_0x45b687(0x16e),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x45b687(0x122),Promise)],OfficialController[_0x45b687(0x116)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x45b687(0x160)])('loginByCode'),(0x0,swagger_1[_0x45b687(0x155)])({'summary':'公众号静默登录'}),__param(0x0,(0x0,common_1[_0x45b687(0x13c)])()),__param(0x1,(0x0,common_1[_0x45b687(0x11a)])()),__metadata(_0x45b687(0x16e),Function),__metadata(_0x45b687(0x11b),[Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x45b687(0x161),null),OfficialController=__decorate([(0x0,swagger_1[_0x45b687(0x12e)])(_0x45b687(0x131)),(0x0,common_1['Controller'])('official'),__metadata('design:paramtypes',[official_service_1['OfficialService']])],OfficialController),exports[_0x45b687(0x168)]=OfficialController;